<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Glucose Translations Formatter</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=yes" />
	</head>
	<body style="background-color: #000; color: #fff; font-family: Comic Sans MS, sans-serif">
		<div style="display: flex; flex-direction: column; align-items: center">
			<h1>Select your chapter file(s)</h1>
			<input type="file" id="files" name="files" multiple />
			<code id="logs"></code>
		</div>
		<script type="module">
			import JSZip from "https://esm.run/jszip";
			import { formatChapter } from "./script.mjs";

			document.getElementById("files").onchange = async function () {
				const a = document.createElement("a");

				if (this.files.length === 1) {
					const { filename, blob } = await formatChapter(this.files[0]);

					a.download = filename;
					a.href = URL.createObjectURL(blob);
				} else {
					const zip = new JSZip();

					for (const file of this.files) {
						const { filename, blob } = await formatChapter(file);
						zip.file(filename, blob);
					}

					a.download = "chapters.zip";
					a.href = URL.createObjectURL(await zip.generateAsync({ type: "blob" }));
				}

				a.click();
			};
		</script>
	</body>
</html>
